.. _sdshare:

=====================================
 Soporte a la especificación SDShare
=====================================
.. sectionauthor:: Antonio Santos Velasco <asantos@viavansi.com>

En el marco de la recomendación del grupo de trabajo del CEN_ `Discovery of and Access to
eGovernment Resources`_ se describe un protocolo para el intercambio de las descripciones
semánticas, definiendo cómo un servicio web de tipo *REST* puede publicar una serie de fuentes web
que describen instantáneas y cambios a las colecciones de descripciones semánticas.

.. _CEN: http://www.cen.eu
.. _Discovery of and Access to eGovernment Resources:
   http://www.cen.eu/CEN/sectors/sectors/isss/workshops/Pages/wsegovshare.aspx

La implementación de *SDShare* que hace *iCMS* hace uso de la librería Atomico_ para servir recursos
completos (*fragments*\ ) e instantáneas de la colección en un momento determinado (*snapshots*\ ).

.. figure:: /images/sdshare/treeview.png
   :scale: 75%
   :align: center

   Estructura del directorio

.. _Atomico: http://code.google.com/p/atomico

El servidor obtiene los contenidos de la colección del sistema productor y crea una
representación de esos contenidos en un subdirectorio del directorio de instalación, nombrado de
igual manera que la colección.

La manera en que se genera la representación *SDShare* es la siguiente: por cada recurso de la
colección se genera un *fragment* (una descripción semántica en formato *rdf+xml*\ ) dentro de la
carpeta ``fragments``, con una serialización del objeto *Java* que contiene los metadatos acerca del
fragmento (fecha de actualización, identificador del recurso y título) en el directorio
``fragments/info``.

Se incluye un ejemplo de fragmento a continuación.

.. literalinclude:: /code/fragment.xml
   :language: xml

Cuando se crea un número determinado de fragmentos (definido en :ref:`configuración
<configuración>`), se mueven los contenidos de la carpeta ``fragments`` a una nueva carpeta que
define un nuevo snapshot (por ejemplo, ``snapshots/snapshot1``), a la vez que se crea un fichero xml
conteniendo metainformación del snapshot en la carpeta ``snapshots/info``. La metainformación del
snapshot es la misma que para un fragment: título, identificador y fecha de actualización.

A diferencia del caso de los fragmentos, la representación de un snapshot no existe en el disco
duro, sino que se genera de forma dinámica con cada petición. Para generar un snapshot se sigue el
siguiente algoritmo: comenzando por el snapshot más reciente en el tiempo se agregan los fragmentos
que existen en el directorio correspondiente y se añaden los identificadores de recurso a una lista
que se va comprobando antes de cada adición. Después se va realizando la operación para el resto de
snapshots siguiendo un orden temporal inverso. La idea detrás es que en el ``snapshot`` se
encuentren las representaciones más recientes de los recursos, evitando la información
desactualizada.

----------------
Feeds de SDShare
----------------

.. note::

  Un feed, canal web o fuente web es un documento utilizado en la redifusión o sindicación web.

  Los feeds suelen estar escritos en XML, siendo los formatos más importantes RSS y Atom. Cada elemento del documento
  suele contener un enlace que apunta al contenido que muestra la entrada. Ya que se utilizan principalmente para
  proporcionar a los usuarios contenido que es actualizado frecuentemente, suelen encontrarse en páginas de noticias,
  weblogs y foros.


El protocolo *SDShare* define la estructura de fuentes web de tipo *Atom* publicadas por un servidor para exponer una o más
colecciones, especificando cuatro tipos distintos de fuente web necesarios para definir una
colección determinada:

**Overview feed**
  Lista las colecciones de descripciones semánticas que el servidor gestiona.

**Collection feed**
  Describe cada colección enlazando con los respectivos *snapshots feed* y *fragments feed*.

**Snapshots feed**
  Lista los *snapshots* de la colección.

**Fragments feed**
  Lista los *fragments* de la colección.

.. figure:: /images/sdshare/feeds.png
  :scale: 75%
  :align: center

  Feeds de SDShare

