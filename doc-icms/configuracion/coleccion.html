

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Definición de una nueva colección &mdash; Interfaz de Interoperabilidad iCMS v1.2.0 documentation</title>
    <link rel="stylesheet" href="../_static/viavansi.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="top" title="Interfaz de Interoperabilidad iCMS v1.2.0 documentation" href="../index.html" />
    <link rel="up" title="Configuración" href="index.html" />
    <link rel="next" title="Ejecución y uso" href="../ejecucion/index.html" />
    <link rel="prev" title="Drivers" href="driver.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="../ejecucion/index.html" title="Ejecución y uso"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="driver.html" title="Drivers"
             accesskey="P">anterior</a> |</li>
        <li><a href="../index.html">Interfaz de Interoperabilidad iCMS v1.2.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Configuración</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="definicion-de-una-nueva-coleccion">
<span id="configuracion-coleccion"></span><h1>Definición de una nueva colección<a class="headerlink" href="#definicion-de-una-nueva-coleccion" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Una vez que se ha copiado el fichero del <em>driver</em> a la carpeta <tt class="docutils literal"><span class="pre">plugins</span></tt> del directorio del
servicio <em>iCMS</em> y se han llevado a cabo todas aquellas acciones adicionales que puedan estar
indicadas en el apartado de instalación correspondiente a la guía del <em>driver</em> que maneje la nueva
colección a definir, habilitar dicha colección consiste en los siguientes pasos:</p>
<p><strong>Añadir la colección al fichero icms-providers.properties</strong></p>
<blockquote>
<p>Cada línea de este fichero define una colección de la siguiente manera:</p>
<div class="highlight-python"><pre>nombre_colección = clase Java que implementa el driver</pre>
</div>
<p>Se puede observar a continuación un fichero de ejemplo en donde se pueden observar dos colecciones
servidas a través de un <em>driver</em> de <em>Drupal</em> y una manejada por el <em>driver</em> creado para el <a class="reference external" href="http://www.juntadeandalucia.es/boja">Boletín
Oficial de la Junta de Andalucía</a>.</p>
<div class="highlight-cfg"><div class="highlight"><pre><span class="na">organismos</span><span class="o">=</span><span class="s">&quot;es.juntadeandalucia.icms.drupal.provider.ICMSCollectionProviderDrupalImpl&quot;</span>
<span class="na">publicaciones</span><span class="o">=</span><span class="s">&quot;es.juntadeandalucia.icms.drupal.provider.ICMSCollectionProviderDrupalImpl&quot;</span>
<span class="na">boja</span><span class="o">=</span><span class="s">&quot;es.juntadeandalucia.icms.boja.provider.ICMSCollectionProviderBojaImpl&quot;</span>
</pre></div>
</div>
</blockquote>
<p><strong>Configurar la nueva colección</strong></p>
<blockquote>
<p>El otro paso a seguir es definir la configuración de la nueva colección. Para ello, en el código
fuente de cada <em>driver</em> se incluye un fichero <em>properties</em> de ejemplo en el que aparecen las
opciones de configuración que admite el <em>driver</em>. Para que <em>iCMS</em> haga la asociación entre la
colección y su fichero de configuración, éste último debe nombrarse icms-<em>nombre_colección</em>.properties</p>
<p>Se puede ver a continuación el fichero de configuración de ejemplo del driver <em>Drupal</em>:</p>
<div class="highlight-java"><pre>// Drupal plugin configuration properties

title="Publicaciones"
author="Viavansi"
modifiable=true
mimetypes=["atom", "text"]

urls {
	list_collection = "http://example.com/icms/publicaciones"
	add_content = "http://example.com/icmsbridge/node/add"
}
	
metadata {
    'dc:title' {
        required = true
        resolvable = false
        queryable = true
    }
    'drupal:title' {
        required = true
        resolvable = false
        queryable = true
    }
    'drupal:changed' {
        required = true
        resolvable = false
        queryable = true
    }
    'id' {
        required = true
        resolvable = false
        queryable = true
    }
    'drupal:type' {
        required = false
        resolvable = false
        queryable = true
    }
    'drupal:revision_timestamp' {
        required = false
        resolvable = false
        queryable = true
    }
    'drupal:name' {
        required = false
        resolvable = false
        queryable = true
    }
    'icms:fecha_pub' {
        field = 'cck:field_fecha_pub'
        searchField = 'field_fecha_value'
        required = false
        resolvable = false
        queryable = true

        metadata {
            'icms:value' {
                field = 'cck:value'
                searchField = 'field_fecha_pub_value'
                required = false
                resolvable = false
                queryable = false
            }
            'icms:timezone' {
                field = 'cck:timezone'
                searchField = 'field_fecha_pub_timezone'
                required = false
                resolvable = false
                queryable = false
            }
            'icms:timezone_db' {
                field = 'cck:timezone_db'
                searchField = 'field_fecha_pub_timezone_db'
                required = false
                resolvable = false
                queryable = false
            }
            'icms:date_type' {
                field = 'cck:date_type'
                searchField = 'field_fecha_pub_date_type'
                required = false
                resolvable = false
                queryable = false
            }
        }
    }
    'dc:author' {
        field = 'cck:field_autor.cck:value'
        searchField = 'field_autor_value'
        required = false
        resolvable = false
        queryable = true
    }
    'icms:lugar' {
        field = 'cck:field_lugar.cck:value'
        searchField = 'field_lugar_value'
        required = false
        resolvable = false
        queryable = true
    }
}
</pre>
</div>
</blockquote>
<p>Los ficheros de configuración de las colecciones se pueden dividir en tres apartados
independientes. Existen unas propiedades generales y comunes a todos los drivers, unas propiedades
exclusivas del driver y, por último, una definición de los metadatos de la colección.</p>
<div class="section" id="propiedades-generales">
<h2>Propiedades generales<a class="headerlink" href="#propiedades-generales" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Las propiedades generales definen el título, autor y permiso de escritura de la colección, además de
los posibles formatos de presentación de los recursos.</p>
<div class="highlight-cfg"><div class="highlight"><pre><span class="na">title</span> <span class="o">=</span> <span class="s">&quot;Publicaciones&quot;</span>
<span class="na">author</span> <span class="o">=</span> <span class="s">&quot;Viavansi&quot;</span>
<span class="na">modifiable</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">mimetypes</span> <span class="o">=</span> <span class="s">[&quot;atom&quot;, &quot;text&quot;]</span>
</pre></div>
</div>
<p>La lista completa de formatos soportados es la siguiente:</p>
<ul class="simple">
<li>Atom (atom)</li>
<li>HTML (html)</li>
<li>RDF+XML (rdf)</li>
<li>Texto (text)</li>
</ul>
</div>
<div class="section" id="propiedades-del-driver">
<h2>Propiedades del driver<a class="headerlink" href="#propiedades-del-driver" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Existirán en la configuración también propiedades relativas exclusivas al <em>driver</em> que maneja la
colección, y que en la mayor parte de las ocasiones son necesarias para un funcionamiento
correcto. En el caso del <em>driver Drupal</em> se definen dos <em>url</em> que permiten listar los contenidos de
la colección y añadir nuevos elementos.</p>
<div class="highlight-cfg"><pre>urls {
  list_collection = "http://example.com/icms/publicaciones"
  add_content = "http://example.com/icmsbridge/node/add"
}</pre>
</div>
</div>
<div class="section" id="metadatos-de-la-coleccion">
<h2>Metadatos de la colección<a class="headerlink" href="#metadatos-de-la-coleccion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El apartado de la configuración dedicado a los metadatos es el más complejo y el que define
realmente cómo se comportará la colección, ya que en él se indican los elementos que se podrán encontrar en
la representación de la colección en formato <em>Atom</em>.</p>
<p>Toda la configuración referente a los metadatos se engloba dentro del contenedor <tt class="docutils literal"><span class="pre">metadata</span></tt>. Éste
puede contener una descripción de los metadatos o a su vez otro contenedor <tt class="docutils literal"><span class="pre">metadata</span></tt>,
posibilitando así una estructura en forma de árbol.</p>
<p>La definición más simple que se puede hacer consiste en el nombre del metadato y las tres
propiedades básicas: <tt class="docutils literal"><span class="pre">required</span></tt>, <tt class="docutils literal"><span class="pre">queryable</span></tt> y <tt class="docutils literal"><span class="pre">resolvable</span></tt>.</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">required</span></tt></dt>
<dd>Si su valor es <tt class="docutils literal"><span class="pre">true</span></tt>, cada elemento de la colección debe contener, al menos, este metadato.</dd>
<dt><tt class="docutils literal"><span class="pre">queryable</span></tt></dt>
<dd>Si su valor es <tt class="docutils literal"><span class="pre">true</span></tt>, los elementos de la colección se pueden filtrar en función del valor de este metadato.</dd>
<dt><tt class="docutils literal"><span class="pre">resolvable</span></tt></dt>
<dd>Si su valor es <tt class="docutils literal"><span class="pre">true</span></tt>, en el caso de que el valor del metadato sea una dirección <em>url</em> el
servicio <em>iCMS</em> se encargará de obtener el recurso asociado a ella e incluirlo en el <em>feed</em> de la
colección.</dd>
</dl>
<p>Cada <em>driver</em> puede definir además nuevas opciones de configuración en la definición de
metadatos. Por ejemplo, el driver de <em>Drupal</em> añade los campos <tt class="docutils literal"><span class="pre">field</span></tt> y <tt class="docutils literal"><span class="pre">searchField</span></tt>, que
indican respectivamente el nombre del metadato en el mismo <em>Drupal</em> y cómo hay que nombrarlo en una búsqueda.</p>
<p>Se incluye un ejemplo a continuación:</p>
<div class="highlight-cfg"><pre>metadata {
  'id' {
      required = true
      resolvable = false
      queryable = true
  }
  'dc:title' {
      required = true
      resolvable = false
      queryable = true
  }
  'drupal:title' {
      required = true
      resolvable = false
      queryable = true
  }
  'drupal:changed' {
      required = true
      resolvable = false
      queryable = true
  }
  'icms:fecha_pub' {
      field = 'cck:field_fecha_pub'
      searchField = 'field_fecha_value'
      required = false
      resolvable = false
      queryable = true

      metadata {
          'icms:value' {
              field = 'cck:value'
              searchField = 'field_fecha_pub_value'
              required = false
              resolvable = false
              queryable = false
          }
      }
  }</pre>
</div>
</div>
</div>
<div class="section" id="configuracion-de-scripts-asociados-a-la-coleccion">
<h1>Configuración de scripts asociados a la colección<a class="headerlink" href="#configuracion-de-scripts-asociados-a-la-coleccion" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Los scripts se configuran en el fichero <tt class="docutils literal"><span class="pre">icms-scripts.properties</span></tt>, que tiene una sintaxis jerarquizada compatible con el
intérprete de configuración <em>ConfigSlurper</em> que se utiliza en <em>iCMS</em>.</p>
<p>Los scripts asociados al inicio se configuran dentro del contenedor <tt class="docutils literal"><span class="pre">init</span></tt>, mientras que los que
están asociados a eventos se encuentran dentro del contenedor <tt class="docutils literal"><span class="pre">event</span></tt>.</p>
<div class="highlight-cfg"><pre>init {
  my_init_script {
    path = "/home/user/icms/data/scripts/my_init_script.groovy"
    parameters {
      collections = "loremipsums"
      solrUrl = "http://localhost:8984/solr"
      icmsUrl = "http://localhost:9991/icms"
      commitSize = "100"
      idSchema = "id"
    }
  }
}</pre>
</div>
<p>Para definir un <em>script</em> a ejecutar al inicio, se crea un nuevo contenedor que identifique al script y
que cuente con, al menos, la propiedad <tt class="docutils literal"><span class="pre">path</span></tt> (que indica el fichero a ejecutar) y el contenedor
<tt class="docutils literal"><span class="pre">parameters</span></tt>, en el que se definen propiedades que se pasan al <em>script</em> como argumentos (los
argumentos que se necesitan y lo que se hace con ellos dependen del <em>script</em> en sí).</p>
<div class="highlight-cfg"><pre>event {
  my_event_script {
    path = "/home/user/icms/data/scripts/SolrEventScript.groovy"
    urlSubscription = "http://localhost:9991/icms"
    collections = "loremipsums"
    conditions = [ "dc:author=CICE", "dc:subject=innovación" ]
    parameters {
      idSchema = "id"
      solrUrl = "http://localhost:8984/solr"
    }
  }
}</pre>
</div>
<p>Además de la ruta del fichero, son parámetros obligatorios en la definición de un <em>script</em> de
eventos las colecciones sobre las que tendrá efecto y la dirección <em>url</em> bajo la que se
puede acceder al servidor <em>iCMS</em> que gestiona la colecciones definidas.</p>
<p>En el parámetro <tt class="docutils literal"><span class="pre">collections</span></tt> se indicarán las colecciones a las que nos queremos suscribir separadas por punto y coma.</p>
<p>Las condiciones (<tt class="docutils literal"><span class="pre">conditions</span></tt>) sobre las cuales nos queremos suscribir a las colecciones indicadas se pondrán en
forma de lista.</p>
<p>Además de esta configuración, podemos declarar, al igual que se hace en el caso de los <em>scripts</em> de
inicio, una serie de parámetros que serán pasados al script cuando éste sea llamado.</p>
<div class="section" id="implementacion-de-los-scripts">
<h2>Implementación de los scripts<a class="headerlink" href="#implementacion-de-los-scripts" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La lógica de las acciones irá escrita en <em>Java</em> y deberá implementar la interfaz correspondiente
dependiendo del tipo de script.</p>
<p>A continuación se incluyen las interfaces a implementar.</p>
<div class="section" id="groovyscript">
<h3>GroovyScript<a class="headerlink" href="#groovyscript" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre></div></td><td class="code"><div class="highlight"><pre><span class="cm">/** Empresa desarrolladora: Viavansi</span>
<span class="cm"> *</span>
<span class="cm"> * Autor: Junta de Andalucía Derechos de explotación propiedad de la</span>
<span class="cm"> * Junta de Andalucía.</span>
<span class="cm"> *</span>
<span class="cm"> * Este programa es software libre: usted tiene derecho a</span>
<span class="cm"> * redistribuirlo y/o modificarlo bajo los términos de la Licencia EUPL</span>
<span class="cm"> * European Public License publicada por el organismo IDABC de la</span>
<span class="cm"> * Comisión Europea, en su versión 1.0. o posteriores.</span>
<span class="cm"> *</span>
<span class="cm"> * Este programa se distribuye de buena fe, pero SIN NINGUNA GARANTÍA,</span>
<span class="cm"> * incluso sin las presuntas garantías implícitas de USABILIDAD o</span>
<span class="cm"> * ADECUACIÓN A PROPÓSITO CONCRETO. Para mas información consulte la</span>
<span class="cm"> * Licencia EUPL European Public License.</span>
<span class="cm"> *</span>
<span class="cm"> * Usted recibe una copia de la Licencia EUPL European Public License</span>
<span class="cm"> * junto con este programa, si por algún motivo no le es posible</span>
<span class="cm"> * visualizarla, puede consultarla en la siguiente URL:</span>
<span class="cm"> * http://ec.europa.eu/idabc/servlets/Doc?id=31099</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the EUPL European Public License</span>
<span class="cm"> * along with this program. If not, see</span>
<span class="cm"> * http://ec.europa.eu/idabc/servlets/Doc?id=31096</span>
<span class="cm"> *</span>
<span class="cm"> * Vous devez avoir reçu une copie de la EUPL European Public License</span>
<span class="cm"> * avec ce programme. Si non, voir</span>
<span class="cm"> * http://ec.europa.eu/idabc/servlets/Doc?id=30194</span>
<span class="cm"> *</span>
<span class="cm"> * Sie sollten eine Kopie der EUPL European Public License zusammen mit</span>
<span class="cm"> * diesem Programm. Wenn nicht, finden Sie da</span>
<span class="cm"> * http://ec.europa.eu/idabc/servlets/Doc?id=29919 **/</span>

<span class="kn">package</span> <span class="n">es</span><span class="o">.</span><span class="na">juntadeandalucia</span><span class="o">.</span><span class="na">icms</span><span class="o">.</span><span class="na">scripts</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm"> * Common interface for all the Groovy scripts</span>
<span class="cm"> * @author Antonio Santos Velasco &lt;asantos@viavansi.com&gt;</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">GroovyScript</span> <span class="o">{</span>

    <span class="cm">/**</span>
<span class="cm">     * Returns the script name</span>
<span class="cm">     * @return string</span>
<span class="cm">     */</span>
    <span class="n">String</span> <span class="nf">getName</span><span class="o">();</span>

    <span class="cm">/**</span>
<span class="cm">     * Returns the script description</span>
<span class="cm">     * @return string</span>
<span class="cm">     */</span>
    <span class="n">String</span> <span class="nf">getDescription</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="initscript">
<h3>InitScript<a class="headerlink" href="#initscript" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="highlight"><pre><span class="cm">/** Empresa desarrolladora: Viavansi</span>
<span class="cm"> *</span>
<span class="cm"> * Autor: Junta de Andalucía Derechos de explotación propiedad de la</span>
<span class="cm"> * Junta de Andalucía.</span>
<span class="cm"> *</span>
<span class="cm"> * Este programa es software libre: usted tiene derecho a</span>
<span class="cm"> * redistribuirlo y/o modificarlo bajo los términos de la Licencia EUPL</span>
<span class="cm"> * European Public License publicada por el organismo IDABC de la</span>
<span class="cm"> * Comisión Europea, en su versión 1.0. o posteriores.</span>
<span class="cm"> *</span>
<span class="cm"> * Este programa se distribuye de buena fe, pero SIN NINGUNA GARANTÍA,</span>
<span class="cm"> * incluso sin las presuntas garantías implícitas de USABILIDAD o</span>
<span class="cm"> * ADECUACIÓN A PROPÓSITO CONCRETO. Para mas información consulte la</span>
<span class="cm"> * Licencia EUPL European Public License.</span>
<span class="cm"> *</span>
<span class="cm"> * Usted recibe una copia de la Licencia EUPL European Public License</span>
<span class="cm"> * junto con este programa, si por algún motivo no le es posible</span>
<span class="cm"> * visualizarla, puede consultarla en la siguiente URL:</span>
<span class="cm"> * http://ec.europa.eu/idabc/servlets/Doc?id=31099</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the EUPL European Public License</span>
<span class="cm"> * along with this program. If not, see</span>
<span class="cm"> * http://ec.europa.eu/idabc/servlets/Doc?id=31096</span>
<span class="cm"> *</span>
<span class="cm"> * Vous devez avoir reçu une copie de la EUPL European Public License</span>
<span class="cm"> * avec ce programme. Si non, voir</span>
<span class="cm"> * http://ec.europa.eu/idabc/servlets/Doc?id=30194</span>
<span class="cm"> *</span>
<span class="cm"> * Sie sollten eine Kopie der EUPL European Public License zusammen mit</span>
<span class="cm"> * diesem Programm. Wenn nicht, finden Sie da</span>
<span class="cm"> * http://ec.europa.eu/idabc/servlets/Doc?id=29919 **/</span>

<span class="kn">package</span> <span class="n">es</span><span class="o">.</span><span class="na">juntadeandalucia</span><span class="o">.</span><span class="na">icms</span><span class="o">.</span><span class="na">scripts</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.logging.Log</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">es.juntadeandalucia.icms.exceptions.ICMSException</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm"> * Interface that will be implemented by each script that performs</span>
<span class="cm"> * action at initialization time</span>
<span class="cm"> * @author Antonio Santos Velasco &lt;asantos@viavansi.com&gt;</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">InitScript</span> <span class="kd">extends</span> <span class="n">GroovyScript</span> <span class="o">{</span>
  <span class="cm">/**</span>
<span class="cm">   * Method to be called at initialization time</span>
<span class="cm">   * @param params Map of parameters passed to the script</span>
<span class="cm">   * @param log Log instance to write events</span>
<span class="cm">   * @throws ICMSException</span>
<span class="cm">   */</span>
  <span class="kt">void</span> <span class="nf">execute</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">params</span><span class="o">,</span> <span class="n">Log</span> <span class="n">log</span><span class="o">)</span> <span class="kd">throws</span>
    <span class="n">ICMSException</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="eventscript">
<h3>EventScript<a class="headerlink" href="#eventscript" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58</pre></div></td><td class="code"><div class="highlight"><pre><span class="cm">/** Empresa desarrolladora: Viavansi</span>
<span class="cm"> *</span>
<span class="cm"> * Autor: Junta de Andalucía Derechos de explotación propiedad de la</span>
<span class="cm"> * Junta de Andalucía.</span>
<span class="cm"> *</span>
<span class="cm"> * Éste programa es software libre: usted tiene derecho a</span>
<span class="cm"> * redistribuirlo y/o modificarlo bajo los términos de la Licencia</span>
<span class="cm"> * EUPL European Public License publicada por el organismo IDABC de la</span>
<span class="cm"> * Comisión Europea, en su versión 1.0. o posteriores.</span>
<span class="cm"> *</span>
<span class="cm"> * Éste programa se distribuye de buena fe, pero SIN NINGUNA GARANTÍA,</span>
<span class="cm"> * incluso sin las presuntas garantías implícitas de USABILIDAD o</span>
<span class="cm"> * ADECUACIÓN A PROPÓSITO CONCRETO. Para mas información consulte la</span>
<span class="cm"> * Licencia EUPL European Public License.</span>
<span class="cm"> *</span>
<span class="cm"> * Usted recibe una copia de la Licencia EUPL European Public License</span>
<span class="cm"> * junto con este programa, si por algún motivo no le es posible</span>
<span class="cm"> * visualizarla, puede consultarla en la siguiente URL:</span>
<span class="cm"> * http://ec.europa.eu/idabc/servlets/Doc?id=31099</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the EUPL European Public License</span>
<span class="cm"> * along with this program. If not, see</span>
<span class="cm"> * http://ec.europa.eu/idabc/servlets/Doc?id=31096</span>
<span class="cm"> *</span>
<span class="cm"> * Vous devez avoir reçu une copie de la EUPL European Public License</span>
<span class="cm"> * avec ce programme. Si non, voir</span>
<span class="cm"> * http://ec.europa.eu/idabc/servlets/Doc?id=30194</span>
<span class="cm"> *</span>
<span class="cm"> * Sie sollten eine Kopie der EUPL European Public License zusammen</span>
<span class="cm"> * mit diesem Programm. Wenn nicht, finden Sie da</span>
<span class="cm"> * http://ec.europa.eu/idabc/servlets/Doc?id=29919 **/</span>

<span class="kn">package</span> <span class="n">es</span><span class="o">.</span><span class="na">juntadeandalucia</span><span class="o">.</span><span class="na">icms</span><span class="o">.</span><span class="na">scripts</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.logging.Log</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">es.juntadeandalucia.icms.ICMSResource</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm"> * Interface which should be implemented by each Groovy script.</span>
<span class="cm"> * @author Eduardo Fernández León &lt;efernandez@viavansi.com&gt;</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">EventScript</span> <span class="kd">extends</span> <span class="n">GroovyScript</span> <span class="o">{</span>

  <span class="cm">/**</span>
<span class="cm">   * This method is invoked when the script is triggered. The body</span>
<span class="cm">   * will implement the action which you want to perform when a</span>
<span class="cm">   * notification is received.</span>
<span class="cm">   * @param collection Collection that has changed</span>
<span class="cm">   * @param resource Resource which been added/updated/removed</span>
<span class="cm">   * @param params Map of parameters the script may need</span>
<span class="cm">   * @param log Log instance</span>
<span class="cm">   * @return boolean whether the execution has been succesful or not</span>
<span class="cm">   */</span>
  <span class="kt">boolean</span> <span class="nf">execute</span><span class="o">(</span><span class="n">String</span> <span class="n">collection</span><span class="o">,</span> <span class="n">ICMSResource</span> <span class="n">resource</span><span class="o">,</span>
    <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">params</span><span class="o">,</span> <span class="n">Log</span> <span class="n">log</span><span class="o">);</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>
<div class="section" id="pasos-a-seguir-despues-de-configurar-la-coleccion">
<h1>Pasos a seguir después de configurar la colección<a class="headerlink" href="#pasos-a-seguir-despues-de-configurar-la-coleccion" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Una vez que se ha creado el fichero de configuración de la colección (y no existiendo problemas de
visibilidad entre las aplicaciones, evidentemente), el servicio <em>iCMS</em> añadirá la colección la
siguiente vez que se <a class="reference internal" href="../ejecucion/arranque.html#arranque"><em>arranque</em></a>.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Contenidos</a></h3>
  <ul>
<li><a class="reference internal" href="#">Definición de una nueva colección</a><ul>
<li><a class="reference internal" href="#propiedades-generales">Propiedades generales</a></li>
<li><a class="reference internal" href="#propiedades-del-driver">Propiedades del driver</a></li>
<li><a class="reference internal" href="#metadatos-de-la-coleccion">Metadatos de la colección</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuracion-de-scripts-asociados-a-la-coleccion">Configuración de scripts asociados a la colección</a><ul>
<li><a class="reference internal" href="#implementacion-de-los-scripts">Implementación de los scripts</a><ul>
<li><a class="reference internal" href="#groovyscript">GroovyScript</a></li>
<li><a class="reference internal" href="#initscript">InitScript</a></li>
<li><a class="reference internal" href="#eventscript">EventScript</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#pasos-a-seguir-despues-de-configurar-la-coleccion">Pasos a seguir después de configurar la colección</a></li>
</ul>

  <h4>Tema anterior</h4>
  <p class="topless"><a href="driver.html"
                        title="Capítulo anterior">Drivers</a></p>
  <h4>Próximo tema</h4>
  <p class="topless"><a href="../ejecucion/index.html"
                        title="Próximo capítulo">Ejecución y uso</a></p>
  <h3>Esta página</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/configuracion/coleccion.txt"
           rel="nofollow">Enseñar el código</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Búsqueda rápida</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Ir a" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="../ejecucion/index.html" title="Ejecución y uso"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="driver.html" title="Drivers"
             >anterior</a> |</li>
        <li><a href="../index.html">Interfaz de Interoperabilidad iCMS v1.2.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Configuración</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Viavansi.
      Creado con <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.4.
    </div>
  </body>
</html>